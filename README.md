# 实践报告
***
## 1.基于555定时器的LED闪烁电路
### 1.1 设计思路
本项目的目标是设计并制作一个基于555定时器的LED闪烁电路。  
__核心芯片__：选用NE555P芯片（DIP-8直插封装），产生精准的周期信号，来实现闪烁的定时。  
__工作模式__：将555芯片配置为无稳态多谐振荡器模式，芯片无需外部触发即可自动在高低电平间循环，输出连续的方波，从而驱动LED周期性地亮灭。  
__供电方案__：采用USB_Type-C 6pin接口，通过数据线连接电脑提供5V直流电源。  
### 1.2关键参数计算：
__目标__：设定LED闪烁频率约为 1 Hz（周期1秒），且亮灭时间大致相等（占空比接近50%）。  
__公式__：基于无稳态模式的计算公式 
$$
f = \dfrac{1.44}{(R_1 + 2R_2)C}
$$
占空比公式 
$$
D = \dfrac{R_1 + R_2}{R_1 + 2R_2} 
$$  
__确定参数__：选定 R1 = R2 = 47 kΩ，定时电容C = 10 μF。经计算，理论频率约为1.02 Hz，占空比约为66.7%.  
__保护与优化设计__：  
LED保护：在输出端串联一个220 Ω的限流电阻，将流过LED的电流限制在安全范围内（约13.6 mA）。  
电源保护：在USB电源入口处添加10 μF的滤波电容，以缓冲电压波动；在555芯片电源引脚附近放置0.1 μF的去耦电容，以滤除高频噪声。  
PCB设计考虑：为增强抗干扰能力和稳定性，在PCB的底层进行了完整的GND铺铜；USB接口的金属外壳通过热焊盘接地，以实现屏蔽。  
### 1.3 电路原理分析
#### 1.3.1 555定时器内部工作原理简析
555芯片内部包含两个电压比较器、一个RS触发器和一颗放电三极管。其阈值由内部三个5kΩ电阻分压设定，分别为2/3 Vcc和1/3 Vcc。外部连接的R1、R2和C构成了充放电网络，通过改变电容C两端的电压来触发比较器，进而控制RS触发器的状态和输出。
#### 1.3.2 无稳态振荡过程详解
先将电路通电初始化，输出高电平，LED点亮，电容持续充电，达到阈值2/3Vcc，电容开始放电，电位翻转为低电平，LED熄灭，电容继续放电，达到下限1/3Vcc又翻转为高电平，电容充电，如此循环往复。
### 1.3.3 元器件选型理由
| 元件名称 | 型号/规格 | 数量 | 选型理由 |
| :--- | :--- | :--- | :--- |
| 555定时器 | NE555P (DIP-8封装) | 1 | 成本低廉，供应广泛，便于手工焊接 |
| 电阻 | 47 kΩ，1/4W | 2 | 为标准值，易于采购。阻值由公式算得。|
| 铝电解电容 | 10 μF，耐压25V | 1 | 在同等容量下体积和成本优于陶瓷电容。25V耐压安全可靠，便于焊接。|
| USB Type-C座子 | 6Pin，仅供电型 | 1 | Type-C接口正反可插。选择仅供电型简化了电路与PCB布局，降低了成本。|
| 电阻 | 5.1 kΩ，1/4W | 2 | 这是USB Type-C协议的强制要求。两个电阻分别下拉CC1和CC2引脚，用于向电源适配器标识本设备为需要5V供电的标准下游设备（SDU）。 |
| 陶瓷电容 (滤波) | 10 μF | 1 | 位于电源入口，用于缓冲USB电源的波动，并为555输出翻转时的瞬时电流需求提供补充。采用陶瓷贴片电容，体积小、ESR低、无极性，便于PCB布局。 |
| 陶瓷电容 (去耦) | 0.1 μF (100 nF) | 1 | 高频去耦电容，紧靠555芯片的电源引脚（VCC和GND）。其作用是为芯片内部高速开关产生的瞬间电流提供就近通路，滤除高频噪声，保证数字电路稳定工作。 |
| LED |5mm红色 | 1 | 5mm直径LED视觉效果明显。在5-20mA驱动下足够亮，且功耗更低。 |
| 限流电阻 | 220 Ω，1/4W | 1 | 将LED电流限制在约13.6mA，使LED安全工作。 |
| 陶瓷电容 | 0.01 μF (10 nF) | 1 | 连接于555的控制电压引脚（第5脚） 到地。稳定内部比较器的参考电压，抑制电源噪声通过此引脚引入对定时精度的影响，进一步提升振荡频率的稳定性。 |  

### 1.4 PCB布线考虑
#### 1.4.1 布局规划与分区策略
__核心思想__：依据信号流向与功能分区，减少相互干扰。  
__功能区域划分__：  
__电源输入区__：将USB Type-C接口放置在电路板边缘，便于插拔。紧挨着布置10μF滤波电容和5.1kΩ CC电阻。  
__核心振荡区__：将555芯片置于板中央或略偏位置，以其为中心，在尽可能近的范围内环形布置其定时网络元件——两个47kΩ电阻和10μF电解电容。  
__输出指示区__：将LED及其220Ω限流电阻放置在远离核心区但易于观察的板边，使输出路径清晰。  
__关键元件优先__：0.1μF去耦电容必须直接放置在555芯片的VCC和GND之间，路径最短，抑制电源噪声、保证芯片稳定工作。  
__晶振替代电容__：0.01μF电容需紧靠555的第5脚放置，以稳定内部参考电压。  
#### 1.4.2 布线规则
__电源线加粗__：  
VCC主线：从USB的VBUS到滤波电容，再到555第8脚的电源主干道，线宽设置为0.5mm以上，以降低阻抗，确保稳定供电。  
地线策略：初期采用较粗导线（0.5mm）简单连通各GND点，为后续铺铜打下基础。最终通过大面积铺铜实现完整地平面，这是提供低噪声参考地、增强抗干扰能力的最佳方法。  
__关键信号线最短化__：555的第7脚（DIS）、第2脚（TRIG）和第6脚（THRES）之间的连接线须优先处理，路径尽量短而直，以减少寄生电容对定时的影响。    
__避免交叉与直角走线__：通过调整元件位置和善用板层，避免信号线长距离交叉。走线拐角使用45°角或圆弧，避免90°直角，以减小高频信号反射和电磁辐射。  
#### 1.4.3 铺铜、散热与丝印
__大面积铺铜接地__：在顶层和底层进行完整的GND网络铺铜。这不仅能提供优异的屏蔽效果、减小环路面积，还能改善散热和机械强度。铺铜与信号线之间会自动保持安全间距（由设计规则DRC保证），不会造成短路。  
__丝印处理__：在丝印层添加元件位号（如R1、C2）、极性标识（电解电容“+”极、LED阴极），引脚定义，极大方便焊接与调试。  
#### 1.4.4 设计验证
完成布局布线后，通过设计规则检查确保无开路、短路及间距违规；并通过Gerber文件预览功能，在提交生产前最后确认物理布局与设计意图完全一致。  
### 1.5 遇到的问题和解决方案
__问题一__：核心参数的计算与确认。  
解决方案：上网查找555定时器的原理讲解，学习555定时器无稳态模式的计算公式 ：频率 f = 1.44 / ((R1 + 2*R2) * C)， 占空比 D = (R1 + R2) / (R1 + 2*R2)。 设定目标频率约为1Hz，并希望占空比接近50%（即亮灭时间相近）。通过计算比较，R1 = R2 = 47kΩ， C = 10μF的方案，理论频率为1.02Hz，且元件更常见，因此作为最终选择。  
__问题二__：不熟悉核心外围电路连接。  
解决方案：查阅数据手册，并上网查找相关教程  
__问题三__:PCB设计时，元器件应遵循何种原则摆放？原理图中使用多个GND符号，在实际PCB中如何保证所有地真正“共地”而不混乱？在USB接口下方大面积铺铜（接地）是否会导致电源（VBUS）短路？  
解决方案：功能分区布局遵循 “输入-处理-输出” 的流向。将USB接口和输入滤波电容置于板边（输入区）；555芯片及其定时网络（R1, R2, C）集中紧凑布置于板中央（核心振荡区）；LED和限流电阻置于另一侧板边（输出指示区）。在PCB中，通过在底层（或顶层）进行大面积铺铜并指定为GND网络，来构建一个完整的地平面。所有需要接地的焊盘都通过“热风焊盘”或直接连接至该铜皮，从而在物理上实现高效、低阻抗的共地。通过查阅资料以及咨询AI，理解铺铜与绝缘，明确铺铜本身不会导致短路，因为其表面覆盖有阻焊层（绿油）。阻焊层会在所有非焊盘区域（包括铺铜）形成绝缘保护，仅露出需要焊接的焊盘。   
***
## 2.USB转串口模块
### 2.1 设计思路
本次设计旨在完成一个稳定可靠、用于学习和基础调试的USB转串口模块。核心思路是采用CH340G芯片，通过数据线连接电脑USB接口的通用串行总线信号，转换为微控制器广泛使用的3.3V TTL电平UART信号。
### 2.2 电路原理
#### 2.2.1 电源与接口模块
**USB Type-C接口**：选用16pin接口，其VBUS引脚提供5V电源，GND为回路，CC1引脚通过5.1kΩ下拉电阻接地，将模块标识为受电设备(DFP)，使主机正常供电。
**电源滤波**：VBUS入口并联10μF电解电容和100nF陶瓷电容（高频去耦），为后续电路提供稳定干净的5V电源(VCC)。
#### 2.2.2 核心转换与防护模块
**CH340G核心电路**：芯片VCC接5V；V3引脚输出内部产生的3.3V，需接100nF退耦电容；XI与XO引脚连接12MHz无源晶振并各接22pF电容到地，构成振荡电路。
**ESD保护电路**：在USB数据线(D+/D-)和电源线(VBUS)上并联TVS二极管阵列。当静电高压出现时，TVS管瞬间导通，将能量泄放到地(GND)，保护芯片。
#### 2.2.3 输出与指示模块
**串口与电源输出**：通过排针引出TXD（发送）、RXD（接收）、GND、3.3V（来自V3）和5V（来自VBUS）信号，为外部设备提供连接与供电。
**状态指示**：VCC通过1kΩ限流电阻驱动电源指示灯(PWR_LED)；TXD信号通过1kΩ限流电阻驱动数据发送指示灯(TX_LED)，发送数据时闪烁。
#### 2.2.4 未使用引脚处理
CH340G的RTS#、DTR#、CTS#等Modem联络信号引脚在基础应用中悬空处理。
### 2.3 元器件及选择理由  
| 关键元器件 | 主要参数 | 选择理由与作用 |
| :--- | :--- | :--- |
| CH340G | USB转串口芯片 | 成熟稳定、成本低廉、外围电路简单，完全满足基础转换需求。 |
| USB Type-C座子 | 16pin，卧贴 | 正反插便利。配合5.1kΩ电阻实现正确供电识别。 |
| 无源晶振 | 12MHz | 提供CH340G工作要求频率。选用直插封装，便于焊接。 |
| 电解电容 | 10μF | 作为储能电容，置于电源入口，应对瞬时大电流需求。 |
| 陶瓷电容 | 100nF (104) | 作为退耦电容，分别紧靠USB电源入口、CH340G的VCC和V3引脚，滤除高频噪声。 |
| 陶瓷电容 | 22pF (x2) | 晶振负载电容，与晶振匹配，构成完整振荡回路。 |
| 电阻 | 5.1kΩ (1%) | Type-C CC配置电阻，精确值确保被可靠识别。 |
| 电阻 | 1kΩ (x2) | LED限流电阻，将电流限制在安全范围内，保证合适亮度。 |
| TVS二极管阵列 | SRV05-4 | ESD保护。集成多通道、低钳位电压、低寄生电容，为数据线和电源线提供瞬态过压防护。 |
| LED | 3mm直插，不同颜色 | 电源与状态指示，直观显示模块上电与数据收发状态。 |
### 2.4 PCB布线考虑
**布局优先，信号流导向**：  
按照“USB接口 → ESD保护 → CH340G → 输出排针”的信号流向布置元件，减少交叉与绕线。  
ESD保护芯片必须紧靠USB接口的D+/D-引脚，确保静电在侵入板内前即被泄放。  
晶振及负载电容必须紧靠CH340G的XI/XO引脚，布局在芯片同一侧，形成紧凑回路。  
**关键信号线布线规则**：
USB差分对(D+/D-)：从ESD到CH340G的这段走线是整个板的最高优先级。必须做到“等长、等宽、等间距、平行走线”，长度差控制在标准范围内，下方保持完整地平面参考，以保障信号完整性。  
晶振走线：尽可能短、粗，采用类差分走线方式。连接晶振的线避免使用直角，晶振下方禁止任何层铺铜。  
**电源与接地处理**：
电源线加粗：VBUS、VCC、3.3V等主电源线宽不小于0.5mm，以降低阻抗。  
电容就近原则：所有退耦电容（特别是V3引脚的100nF电容）必须放置在对应芯片电源引脚最近处，接地端通过短而粗的走线或多过孔直接连接到地平面。   
完整地平面与铺铜：顶层和底层均进行GND铺铜，形成完整屏蔽。通过大量过孔到底面，为所有信号提供低阻抗回流路径。
**特殊区域处理**：
铺铜避让：在USB座子金属外壳、差分信号线的顶层、晶振本体下方设置禁止铺铜区，防止寄生电容影响。  
### 2.5 遇到的问题与解决方案
__问题一__：USB Type-C接口的CC引脚配置困惑,不确定Type-C接口的CC1和CC2引脚应如何连接，为何只在一个CC引脚接下拉电阻。
解决方案：上网查阅得知，作为下行设备（受电设备），只需在任意一个CC引脚（如CC1）上连接一个5.1kΩ精密电阻到地，即可告知主机“需要供电”。另一引脚（CC2）悬空，保证模块被电脑正确识别和供电。  
__问题二__：晶振电路布局困难，走线长度难以达到理论要求。  
解决方案：保证布局紧凑，反复调整晶振位置，优先确保晶振与电容紧靠芯片，走线短直、无绕线，单段走线控制在10mm以内即可稳定工作。  
**问题三**：ESD保护器件选型与连接不清晰，对ESD保护器件具体型号（如SRV05-4）、工作原理（为何有的电阻增大、有的减小）及其精确连接方式存在疑问。  
解决方案：上网查找ESD保护的原理，原因，常见器件，确定选用TVS二极管阵列SRV05-4，因其集成度高、响应快、寄生电容低，适合保护USB高速信号。  
**问题四**：USB差分信号线（D+/D-）布线规则冲突，不能同时满足平行，等距，等长等要求。  
解决方案：上网检索信息，反复进行比对，决定首先保证等长，其次是平行，等距。  
**问题五**：布局冲突导致差分线无法平行走线。在布线时，由于CC1配置电阻的阻挡，差分线难以在不交叉的情况下保持平行。  
解决方案：采用 “过孔换层” 技巧。将CC1等低速配置信号线通过过孔引至底层布线，为顶层的USB高速差分对让出干净、无阻碍的平行走线通道。  
**问题六**：晶振、USB座子下方铺铜策略不明确   
解决方案：通过上网查找，询问AI，决定了在晶振下方禁止铺铜，USB金属座下方、差分对下方顶层禁止铺铜。    
